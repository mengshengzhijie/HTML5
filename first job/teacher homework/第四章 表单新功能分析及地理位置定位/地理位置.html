<div id="article_content" class="article_content clearfix">
        <link rel="stylesheet" href="https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/kdoc_html_views-1a98987dfd.css">
        <link rel="stylesheet" href="https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/ck_htmledit_views-dc4a025e85.css">
                <div id="content_views" class="htmledit_views">
                    <h4><a name="t0"></a><span style="color:#4da8ee;">1，Geolocation API基本知识&nbsp;</span></h4> 
<blockquote> 
 <p><strong><span style="color:#fe2c24;">位置信息：</span>HTML5 Geolocation API的使用方法相当简单。请求一个位置信息，如果用户同意，浏览器就会返回位置信息，该位置信息是通过支持HTML5地理定位功能的底层设备(手机、笔记本电脑等)提供给浏览器的。<span style="color:#956fe7;">位置信息由维度、经度坐标和其他一些元数据组成。</span></strong></p> 
 <ul><li><strong><span style="color:#956fe7;">经度和维度坐标：</span>位置信息主要有一对维度和经度坐标组成。 例如坐标：维度：39.17222、维度：-120.13778 其中维度(距离赤道以北或以南的数值表示)是39.17222，经度(距离英国格林威治以东或以西的数值表示)是-120.13778。</strong></li><li><strong><span style="color:#956fe7;">经纬度</span>可以用以下两种方式表示：（1）十进制格式(例如：39.17222); （2）&nbsp; &nbsp;DMS(Degree Minute Second，角度)格式(例如，66°33' 38" )。</strong></li></ul> 
 <p><strong>除了经纬度，HTML5 Geolocation还提供了位置坐标的准确度，以及根据浏览器的硬件设备是否能够提供海拔、海拔准确度、形式方向和速度等元数据，若无法提供则返回null。</strong></p> 
 <p><span style="color:#fe2c24;"><strong>位置的由来：</strong></span>Geolocation仅是检索设备提供位置信息的API，并且通过该API检索到的数据只具有某种程度的准确性。并不能保证设备返回的实际位置是精确的。</p> 
 <p><strong><span style="color:#fe2c24;">设备可以使用的数据源：</span>（1）IP地址。（2）三维坐标：GPS(Global Positioning System,全球定位系统)、从RFID，Wi-Fi和蓝牙到Wi-Fi的MAC地址、GSM或CDMA手机的ID。（3）用户自定义数据。</strong></p> 
</blockquote> 
<blockquote> 
 <p><span style="color:#fe2c24;"><strong>【IP地址地理定位数据】</strong></span>基于IP地址的地理定位的实现方式是：自动查询用户的IP地址，然后检索器注册的物理地址。因此，如果用户的IP地址是ISP提供的，其位置往往是由服务供应商的物理地址决定的，该地址可能距离用户数千米。</p> 
 <ul><li><strong>优点：</strong>任何地方都可用、在服务器端处理。</li><li><strong>缺点：</strong>不精确、运算代价大。</li></ul> 
 <p><span style="color:#fe2c24;"><strong>【Wi-Fi地理定位数据】</strong></span><span style="color:#0d0016;">基于WiFi的地理定位信息是通过三角距离计算得出的，这个三角距离值得是用户当前位置到一只的多个WiFi接入点的距离。不同于GPS，WiFi在室内也非常准确。</span></p> 
 <ul><li><strong>优点：</strong>精确、可在室内使用、可以简单、快捷定位。</li><li><strong>缺点：</strong>在乡村这些无线接入点较少的地区效果不好。</li></ul> 
 <p><span style="color:#fe2c24;"><strong>【手机地理定位数据】</strong></span>基于手机的地理定位信息是通过用户到一些基站的三角距离确定的。这种方法可提供相当准确的位置结果。这种方法通常同基于Wi-Fi和基于<a href="https://so.csdn.net/so/search?q=GPS&amp;spm=1001.2101.3001.7020" target="_blank" class="hl hl-1" data-report-view="{&quot;spm&quot;:&quot;1001.2101.3001.7020&quot;,&quot;dest&quot;:&quot;https://so.csdn.net/so/search?q=GPS&amp;spm=1001.2101.3001.7020&quot;,&quot;extra&quot;:&quot;{\&quot;searchword\&quot;:\&quot;GPS\&quot;}&quot;}" data-report-click="{&quot;spm&quot;:&quot;1001.2101.3001.7020&quot;,&quot;dest&quot;:&quot;https://so.csdn.net/so/search?q=GPS&amp;spm=1001.2101.3001.7020&quot;,&quot;extra&quot;:&quot;{\&quot;searchword\&quot;:\&quot;GPS\&quot;}&quot;}" data-tit="GPS" data-pretit="gps">GPS</a>的地理定位信息结合使用。</p> 
 <ul><li><strong>优点：</strong>相当准确、可以在室内使用、可以简单，快捷定位。</li><li><strong>缺点：</strong>需要能够访问手机或其modem的设备、在基站较少的偏远地区效果不好。</li></ul> 
 <p><span style="color:#fe2c24;"><strong>【用户自定义的地理定位数据】</strong></span>应用程序可能允许用户输入他们的地理、邮政编码和其他的一些详细信息。应用程序可以利用这些信息来提供位置感知服务。</p> 
 <ul><li><strong>优点：</strong>用户可以获得比程序定位服务更准确的位置数据、允许地理定位服务结果作为备用位置信息、用户自行输入可能比自动检测更快。</li><li><strong>缺点：</strong>可能很不准确，特别是当用户位置变更后。</li></ul> 
</blockquote> 
<h4><a name="t1"></a><span style="color:#4da8ee;">2，Geolocation API基本操作</span></h4> 
<blockquote> 
 <p><strong><span style="color:#fe2c24;">HTML5 Geolocation API是新增的地理位置应用程序接口。</span>它提供了一个可以准确感知浏览器用户当前地理位置的方法。如果浏览器支持，且设备具有定位功能，就能够直接使用这个API来获取当前位置信息。</strong></p> 
 <p></p> 
 <p><span style="color:#fe2c24;"><strong>window.navigator.geolocation</strong><strong>对象存在</strong><strong>3</strong><strong>个方法：</strong></span></p> 
 <ul><li><span style="color:#956fe7;"><strong>getCurrentPosition 获取当前地理位置。</strong></span></li><li><span style="color:#956fe7;"><strong>watchPosition 监视位置信息。</strong></span></li><li><span style="color:#956fe7;"><strong>clearWatch 停止获取位置信息。</strong></span></li></ul> 
 <p><span style="color:#fe2c24;"><strong>【</strong></span><span style="color:#fe2c24;"><strong>检查浏览器是否支持地理定位</strong></span><span style="color:#fe2c24;"><strong>】</strong></span></p> 
 <pre data-index="0"><code class="hljs language-csharp"><ol class="hljs-ln" style="width:100%"><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-function">function <span class="hljs-title">getLocation</span>()</span> {</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">	<span class="hljs-keyword">if</span> (navigator.geolocation) {</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">		navigator.geolocation.getCurrentPosition(showPosition, showError);</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">	} <span class="hljs-keyword">else</span> {</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="5"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">		x.innerHTML = <span class="hljs-string">"该浏览器不支持获取地理位置。"</span>;</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="6"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">	}</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="7"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">}</div></div></li></ol></code><div class="hljs-button signin" data-title="登录后复制" data-report-click="{&quot;spm&quot;:&quot;1001.2101.3001.4334&quot;}" onclick="hljs.signin(event)"></div></pre> 
</blockquote> 
<blockquote> 
 <p><span style="color:#fe2c24;"><strong>【</strong></span><span style="color:#fe2c24;"><strong>单次定位的请求】</strong></span><span style="color:#0d0016;"><strong>只检索或请求一次用户位置即可。例如，如果要查询在接下来的一个小时内放映某大片的最近的电影院。</strong></span></p> 
 <pre data-index="1"><code class="hljs language-cpp"><ol class="hljs-ln" style="width:100%"><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">getCurrentPosition</span><span class="hljs-params"><span class="hljs-params">(in PositionCallback successCallback,</span></span></span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-params">                        in optional PositionErrorCallback errorCallback,</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-params">                        in optional PositionOptions options)</span>;</div></div></li></ol></code><div class="hljs-button signin" data-title="登录后复制" data-report-click="{&quot;spm&quot;:&quot;1001.2101.3001.4334&quot;}" onclick="hljs.signin(event)"></div></pre> 
 <p><span style="color:#956fe7;"><strong>getCurrentPosition(successCallback, onError, options)</strong></span>方法接受1个、2个或者3个参数。第1个参数为获取当前地理位置信息成功时所执行的回调函数，第2个参数为获取当前地理位置信息失败时所执行的回调函数，第3个参数为一些可选属性的列表。其中，第2、3个参数为可选参数。</p> 
 <p><span style="color:#fe2c24;"><strong>第1个参数，</strong></span><span style="color:#956fe7;"><strong>在获取地理位置信息成功时执行的回调函数中，带有一个position参数，它是一个Geoposition对象。该对象有以下两个属性：</strong></span></p> 
 <p><strong><span style="color:#1a439c;">（1）timestamp属性，</span>获取到地理坐标的时间戳信息，值为从1970年1月1日至今的毫秒数 <span style="color:#1a439c;">（2）coords属性，</span>coords属性是一个Coordinates类型对象，包含下面这些属性：</strong></p> 
 <ul><li><strong>latitude: (Number 类型 )，坐标纬度值。</strong></li><li><strong>longitude: (Number 类型 )，坐标经度值。</strong></li><li><strong>altitude: (Number 类型 )，海拔高度信息，如果无法获取此信息，则此值为空（null）。</strong></li><li><strong>accuracy: (Number 类型 )，地理坐标信息的精确度信息，单位为米，其有效值必须大于0。</strong></li><li><strong>altitudeAccuracy: (Number 类型 )，海拔高度的精确度信息，单位为米，其有效值必须大于0。如果无法获取海拔信息，则此值为空（null）。</strong></li><li><strong>heading: (Number 类型 )，表示设备移动的方向，范围为0到360，表示相对于正北方向的角度。如果无法获取此信息，则此值为空（null）。如果设备没有移动则此值为NaN。</strong></li><li><strong>speed: (Number 类型 )，表示设备移动的速度，单位为米每秒（m/s），其有效值必须大于0。如果无法获取速度信息，则此值为空（null）。</strong></li></ul> 
 <p><strong><span style="color:#fe2c24;">第2个参数，</span>在获取地理位置信息失败时执行的回调函数中，带有一个error参数，它是一个PositionError对象。该对象有以下两个属性：</strong></p> 
 <p><span style="color:#1a439c;"><strong>（1）code属性，可能值：</strong></span></p> 
 <ul><li><span style="color:#0d0016;"><strong>当属性值为1时，表示用户拒绝了位置服务，"User denied Geolocation"。</strong></span></li><li><span style="color:#0d0016;"><strong>&nbsp;当属性值为2时，表示获取不到位置信息，"Timeout expired"。</strong></span></li><li><span style="color:#0d0016;"><strong>当属性值为3时，表示获取信息超时错误。</strong></span></li><li><span style="color:#0d0016;"><strong>UNKNOW_ERROR，表示除了以上几种错误之外的错误。</strong></span></li></ul> 
 <p><span style="color:#1a439c;"><strong>（2）message属性：</strong></span><span style="color:#0d0016;"><strong>message属性值为一个字符串，包含了错误信息，这个错误信息在我们开发和调试时非常有用。</strong></span></p> 
 <p><span style="color:#fe2c24;"><strong>第3个参数</strong></span><span style="color:#0d0016;"><strong>是一个可选属性的列表，说明如下：</strong></span></p> 
 <p><span style="color:#1a439c;"><strong>（1）enableHighAccuracy属性，</strong></span><span style="color:#0d0016;"><strong>是否要求高精度的地理位置信息。这个参数在很多设备上设置了都没用，因为使用在设备上时需要结合设备电量、具体地理情况来结合考虑。因此，多数情况下把该属性设为默认，由设备自身来调整 当需要高精度的位置信息时，例如 饿了么网站对用户的定位，就需要将 enableHighAccuracy设为 true。</strong></span></p> 
 <p><span style="color:#1a439c;"><strong>（2）timeout属性，</strong></span><span style="color:#0d0016;"><strong>超时限制（单位为毫秒）。如果在该时间内未获取到地理位置信息，则返回错误。 如果与网站页面渲染有关的请求的数据依赖于经纬度信息，那么最好设置一个 timeout的最大值，因为有时候可能设备获位置信息的响应时间会比较长，这将导致页面长时间的空白，用户体验很不好。</strong></span></p> 
 <p><span style="color:#1a439c;"><strong>（3）maximumAge属性，</strong></span><span style="color:#0d0016;"><strong>对地理位置信息进行缓存的有效时间（单位为毫秒）。如果该值设为0，则每次都去重新获取地理位置信息。 例如maximumAge：120000（1分钟是60000）。如果11点整的时候获取过一次地理位置信息，11:01的时候，再次调用getCurrentPosition重新获取地理位置信息，则返回的依然为11:00时的数据（因为设置的缓存有效时间为2分钟）。超过这个时间后缓存的地理位置信息被废弃，尝试重新获取地理位置信息。如果该值被指定为0，则无条件重新获取新的地理位置信息。</strong></span></p> 
 <p><span style="color:#956fe7;"><strong>如果需要对地理位置进行实时或者一定时间内的实时刷新，那么可指定 maximumAge的值。</strong></span></p> 
</blockquote> 
<blockquote> 
 <p><span style="color:#fe2c24;"><strong>【重复性的位置更新请求】</strong></span><span style="color:#0d0016;"><strong>有时候，仅更新一次是不够的。还好，Geolocation服务的设计者使应用程序可以在单次请求用户定位和以既定时间间隔多次请求用户位置间相互转换。事实上，转换的方式很简单，只需要变换函数请求即可。</strong></span></p> 
 <p><span style="color:#956fe7;"><strong>重复更新的好处：</strong></span><span style="color:#1a439c;"><strong>如有一个页面，随着观察者在城镇周围移动，网页上的方向指示也随之改变，再假设关于一个加油站的页面，随着用户开车在高速公路上持续行驶，页面不断更新显示最近的加油站。另外，还可以在一个页面中记录和传送用户位置来实现回溯已走的路线。如果位置信息一发生改变，就能传递给应用程序，那么前面所假设的所有服务都会变得很容易实现。</strong></span></p> 
 <pre data-index="2"><code class="hljs language-scss">navigator<span class="hljs-selector-class">.geolocation</span><span class="hljs-selector-class">.watchCurrentPosition</span>(onSuccess,onError,options);</code><div class="hljs-button signin" data-title="登录后复制" data-report-click="{&quot;spm&quot;:&quot;1001.2101.3001.4334&quot;}" onclick="hljs.signin(event)"></div></pre> 
 <p>用于注册监听器，在设备的地理位置发生改变的时候自动被调用。也可以选择特定的错误处理函数。<strong>此方法同样存在 3个参数：successCallback, errorCallback, options，并且与上面 getCurrentPosition相同，就不多加累赘了。另外，此方法会返回一个 ID，可以通过此 ID来取消监听器。</strong></p> 
</blockquote> 
<blockquote> 
 <p><span style="color:#fe2c24;">【<strong>获取当前地理位置</strong>】</span></p> 
 <pre data-index="3" class="set-code-hide" name="code"><code class="hljs language-cobol"><ol class="hljs-ln" style="width:100%"><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">navigator.geolocation.getCurrentPosition(showPosition, showError);</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-keyword">function</span> showPosition(position) {</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">	x.innerHTML <span class="hljs-operator">=</span> <span class="hljs-string">"纬度: "</span> <span class="hljs-operator">+</span> position.coords.latitude <span class="hljs-operator">+</span><span class="hljs-string">"&lt;br&gt;经度: "</span> <span class="hljs-operator">+</span> position.coords.longitude;</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">}</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="5"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-keyword">function</span> showError(<span class="hljs-keyword">error</span>) {</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="6"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">	switch (<span class="hljs-keyword">error</span>.<span class="hljs-keyword">code</span>) {</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="7"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">		case <span class="hljs-keyword">error</span>.PERMISSION_DENIED:</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="8"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">			x.innerHTML <span class="hljs-operator">=</span> <span class="hljs-string">"用户拒绝对获取地理位置的请求。"</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="9"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">			break;</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="10"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">		case <span class="hljs-keyword">error</span>.POSITION_UNAVAILABLE:</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="11"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">			x.innerHTML <span class="hljs-operator">=</span> <span class="hljs-string">"位置信息是不可用的。"</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="12"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">			break;</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="13"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">		case <span class="hljs-keyword">error</span>.TIMEOUT:</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="14"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">			x.innerHTML <span class="hljs-operator">=</span> <span class="hljs-string">"请求用户地理位置超时。"</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="15"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">			break;</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="16"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">		case <span class="hljs-keyword">error</span>.UNKNOWN_<span class="hljs-keyword">ERROR</span>:</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="17"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">			x.innerHTML <span class="hljs-operator">=</span> <span class="hljs-string">"未知错误。"</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="18"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">			break;</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="19"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">	}</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="20"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">}</div></div></li></ol></code><div class="hide-preCode-box"><span class="hide-preCode-bt" data-report-view="{&quot;spm&quot;:&quot;1001.2101.3001.7365&quot;}"><img class="look-more-preCode contentImg-no-view" src="https://csdnimg.cn/release/blogv2/dist/pc/img/newCodeMoreWhite.png" alt="" title=""></span></div><div class="hljs-button signin" data-title="登录后复制" data-report-click="{&quot;spm&quot;:&quot;1001.2101.3001.4334&quot;}" onclick="hljs.signin(event)"></div></pre> 
 <p><span style="color:#fe2c24;">【<strong>持续监视位置信息</strong>】</span></p> 
 <pre data-index="4"><code class="hljs language-scss">navigator<span class="hljs-selector-class">.geolocation</span><span class="hljs-selector-class">.watchPosition</span>(showPosition, showError);</code><div class="hljs-button signin" data-title="登录后复制" data-report-click="{&quot;spm&quot;:&quot;1001.2101.3001.4334&quot;}" onclick="hljs.signin(event)"></div></pre> 
 <p><span style="color:#fe2c24;">【</span><strong style="color:#fe2c24;">停止监视位置信息</strong><span style="color:#fe2c24;">】</span><strong>如果应用程序不再需要接受有关用户的持续位置更新，则只需调用clearWatch()函数，如下所示：</strong></p> 
 <pre data-index="5"><code class="hljs language-scss">navigator<span class="hljs-selector-class">.geolocation</span><span class="hljs-selector-class">.clearWatch</span>(watchId);</code><div class="hljs-button signin" data-title="登录后复制" data-report-click="{&quot;spm&quot;:&quot;1001.2101.3001.4334&quot;}" onclick="hljs.signin(event)"></div></pre> 
 <p><strong>watchId表示一个唯一的监视请求以便将来取消监视。所以，如果应用程序要停止接收位置更新信息。</strong></p> 
 <pre data-index="6"><code class="hljs language-scss">navigator<span class="hljs-selector-class">.geolocation</span><span class="hljs-selector-class">.clearWatch</span>(watchId);</code><div class="hljs-button signin" data-title="登录后复制" data-report-click="{&quot;spm&quot;:&quot;1001.2101.3001.4334&quot;}" onclick="hljs.signin(event)"></div></pre> 
</blockquote> 
<h4><a name="t2"></a><span style="color:#4da8ee;">3，百度API</span></h4> 
<blockquote> 
 <p><span style="color:#fe2c24;"><strong>使用步骤：</strong></span></p> 
 <ul><li><strong>注册百度账号，在http://lbsyun.baidu.com/apiconsole/key?application=key&nbsp;页面申请密钥(AK)</strong></li><li><strong>页面引入</strong></li></ul> 
 <pre data-index="7"><code class="hljs language-cobol"><span class="hljs-operator">&lt;</span>script <span class="hljs-keyword">type</span><span class="hljs-operator">=</span><span class="hljs-string">"text/javascript"</span> src<span class="hljs-operator">=</span><span class="hljs-string">"http://api.map.baidu.com/api?v=2.0&amp;ak=你的密钥"</span><span class="hljs-operator">&gt;</span><span class="hljs-operator">&lt;</span><span class="hljs-operator">/</span>script<span class="hljs-operator">&gt;</span></code><div class="hljs-button signin" data-title="登录后复制" data-report-click="{&quot;spm&quot;:&quot;1001.2101.3001.4334&quot;}" onclick="hljs.signin(event)"></div></pre> 
 <ul><li><strong>地图需要一个HTML元素作为容器，这样才能展现到页面上。这里我们创建了一个div元素。</strong></li></ul> 
 <pre data-index="8"><code class="hljs language-cobol"><span class="hljs-operator">&lt;</span>body<span class="hljs-operator">&gt;</span><span class="hljs-operator">&lt;</span>div id <span class="hljs-operator">=</span> <span class="hljs-string">"allmap"</span><span class="hljs-operator">&gt;</span><span class="hljs-operator">&lt;</span><span class="hljs-operator">/</span>div<span class="hljs-operator">&gt;</span><span class="hljs-operator">&lt;</span><span class="hljs-operator">/</span>body<span class="hljs-operator">&gt;</span></code><div class="hljs-button signin" data-title="登录后复制" data-report-click="{&quot;spm&quot;:&quot;1001.2101.3001.4334&quot;}" onclick="hljs.signin(event)"></div></pre> 
 <ul><li><strong>实例化地图</strong></li></ul> 
 <pre data-index="9" class="set-code-hide" name="code"><code class="hljs language-cobol"><ol class="hljs-ln" style="width:100%"><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-operator">&lt;</span>script <span class="hljs-keyword">type</span><span class="hljs-operator">=</span><span class="hljs-string">"text/javascript"</span><span class="hljs-operator">&gt;</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">&nbsp;&nbsp;&nbsp; <span class="hljs-operator">/</span><span class="hljs-operator">/</span>百度地图API功能</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="5"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">&nbsp;&nbsp;&nbsp; var map <span class="hljs-operator">=</span> new BMap.Map(<span class="hljs-string">"allmap"</span>);</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="6"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="7"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">&nbsp;&nbsp;&nbsp; map.centerAndZoom(new BMap.Point(<span class="hljs-number">120.378386,30.309756</span>),<span class="hljs-number">15</span>);<span class="hljs-operator">/</span><span class="hljs-operator">/</span>根据坐标初始化地图</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="8"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="9"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">&nbsp;&nbsp;&nbsp;&nbsp; map.enableScrollWheelZoom(<span class="hljs-keyword">true</span>);</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="10"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="11"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">&nbsp;&nbsp;&nbsp; map.addControl(new BMap.NavigationControl());&nbsp;&nbsp; <span class="hljs-operator">/</span><span class="hljs-operator">/</span>平移缩放控件</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="12"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="13"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">&nbsp;&nbsp;&nbsp; map.addControl(new BMap.ScaleControl());&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="hljs-operator">/</span><span class="hljs-operator">/</span>比例尺</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="14"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="15"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">&nbsp;&nbsp;&nbsp; map.addControl(new BMap.OverviewMapControl());&nbsp; <span class="hljs-operator">/</span><span class="hljs-operator">/</span>缩略地图</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="16"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="17"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">&nbsp;&nbsp;&nbsp; map.addControl(new BMap.MapTypeControl());&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="hljs-operator">/</span><span class="hljs-operator">/</span>地图类型</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="18"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="19"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">&nbsp;&nbsp;&nbsp; map.setCurrentCity(<span class="hljs-string">"杭州"</span>); <span class="hljs-operator">/</span><span class="hljs-operator">/</span> 仅当设置城市信息时，MapTypeControl的切换功能才能可用</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="20"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="21"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">&nbsp;&nbsp;&nbsp;&nbsp; <span class="hljs-operator">/</span><span class="hljs-operator">/</span>添加标注</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="22"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="23"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">&nbsp;&nbsp;&nbsp; var marker <span class="hljs-operator">=</span> new BMap.Marker(new BMap.Point(<span class="hljs-number">120.378386,30.309756</span>));&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="hljs-operator">/</span><span class="hljs-operator">/</span> 创建标注</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="24"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="25"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">&nbsp;&nbsp;&nbsp; map.addOverlay(marker);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="hljs-operator">/</span><span class="hljs-operator">/</span> 将标注添加到地图中</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="26"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="27"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-operator">&lt;</span><span class="hljs-operator">/</span>script<span class="hljs-operator">&gt;</span></div></div></li></ol></code><div class="hide-preCode-box"><span class="hide-preCode-bt" data-report-view="{&quot;spm&quot;:&quot;1001.2101.3001.7365&quot;}"><img class="look-more-preCode contentImg-no-view" src="https://csdnimg.cn/release/blogv2/dist/pc/img/newCodeMoreWhite.png" alt="" title=""></span></div><div class="hljs-button signin" data-title="登录后复制" data-report-click="{&quot;spm&quot;:&quot;1001.2101.3001.4334&quot;}" onclick="hljs.signin(event)"></div></pre> 
</blockquote> 
<blockquote> 
 <pre class="has set-code-hide" data-index="10" name="code"><code class="hljs language-cobol"><ol class="hljs-ln" style="width:1075px"><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-operator">&lt;</span>!DOCTYPE html<span class="hljs-operator">&gt;</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-operator">&lt;</span>html<span class="hljs-operator">&gt;</span>   </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-operator">&lt;</span>title<span class="hljs-operator">&gt;</span>Geolocation和百度地图API进行地理定位实例<span class="hljs-operator">&lt;</span><span class="hljs-operator">/</span>title<span class="hljs-operator">&gt;</span>   </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    <span class="hljs-operator">&lt;</span>head<span class="hljs-operator">&gt;</span>   </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="5"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        <span class="hljs-operator">&lt;</span>meta charset<span class="hljs-operator">=</span><span class="hljs-string">"UTF-8"</span> <span class="hljs-operator">/</span><span class="hljs-operator">&gt;</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="6"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        <span class="hljs-operator">&lt;</span>meta name<span class="hljs-operator">=</span><span class="hljs-string">"viewport"</span> <span class="hljs-keyword">content</span><span class="hljs-operator">=</span><span class="hljs-string">"width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no"</span><span class="hljs-operator">&gt;</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="7"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        <span class="hljs-operator">&lt;</span>style<span class="hljs-operator">&gt;</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="8"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">            body, html,#container {</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="9"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">                width: <span class="hljs-number">100</span>%;</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="10"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">                height: <span class="hljs-number">100</span>%;</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="11"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">                <span class="hljs-keyword">overflow</span>: hidden;</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="12"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">                margin:<span class="hljs-number">0</span>;</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="13"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">                font-family:<span class="hljs-string">"微软雅黑"</span>;</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="14"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">            }</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="15"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        <span class="hljs-operator">&lt;</span><span class="hljs-operator">/</span>style<span class="hljs-operator">&gt;</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="16"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        <span class="hljs-operator">&lt;</span>script <span class="hljs-keyword">type</span><span class="hljs-operator">=</span><span class="hljs-string">"text/javascript"</span> src<span class="hljs-operator">=</span><span class="hljs-string">"http://api.map.baidu.com/api?v=2.0&amp;ak=**********"</span><span class="hljs-operator">&gt;</span><span class="hljs-operator">&lt;</span><span class="hljs-operator">/</span>script<span class="hljs-operator">&gt;</span>   </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="17"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    <span class="hljs-operator">&lt;</span><span class="hljs-operator">/</span>head<span class="hljs-operator">&gt;</span>   </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="18"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    <span class="hljs-operator">&lt;</span>body<span class="hljs-operator">&gt;</span>   </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="19"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        <span class="hljs-operator">&lt;</span>div id<span class="hljs-operator">=</span><span class="hljs-string">"status"</span> style<span class="hljs-operator">=</span><span class="hljs-string">"text-align: center"</span><span class="hljs-operator">&gt;</span><span class="hljs-operator">&lt;</span><span class="hljs-operator">/</span>div<span class="hljs-operator">&gt;</span>   </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="20"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        <span class="hljs-operator">&lt;</span>div id<span class="hljs-operator">=</span><span class="hljs-string">"container"</span><span class="hljs-operator">&gt;</span><span class="hljs-operator">&lt;</span><span class="hljs-operator">/</span>div<span class="hljs-operator">&gt;</span>   </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="21"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    <span class="hljs-operator">&lt;</span><span class="hljs-operator">/</span>body<span class="hljs-operator">&gt;</span>   </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="22"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-operator">&lt;</span><span class="hljs-operator">/</span>html<span class="hljs-operator">&gt;</span>   </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="23"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">     </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="24"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-operator">&lt;</span>script <span class="hljs-keyword">type</span><span class="hljs-operator">=</span><span class="hljs-string">"text/javascript"</span><span class="hljs-operator">&gt;</span>   </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="25"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    <span class="hljs-operator">/</span><span class="hljs-operator">/</span>默认地理位置设置为上海市浦东新区 </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="26"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    var x <span class="hljs-operator">=</span> <span class="hljs-number">121.48789949</span>,y <span class="hljs-operator">=</span> <span class="hljs-number">31.24916171</span>;</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="27"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    var tip <span class="hljs-operator">=</span> document.getElementById(<span class="hljs-string">"status"</span>);</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="28"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    window.onload <span class="hljs-operator">=</span> <span class="hljs-keyword">function</span>() {   </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="29"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        <span class="hljs-keyword">if</span>(navigator.geolocation) {</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="30"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">            <span class="hljs-operator">/</span><span class="hljs-operator">/</span> navigator有<span class="hljs-number">3</span>个方法:clearWatch、getCurrentPosition、watchPosition</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="31"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">            navigator.geolocation.getCurrentPosition(showPosition);  </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="32"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">                <span class="hljs-operator">/</span><span class="hljs-operator">/</span> 百度地图API功能   </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="33"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">                var map <span class="hljs-operator">=</span> new BMap.Map(<span class="hljs-string">"container"</span>, {enableMapClick:<span class="hljs-keyword">false</span>}); <span class="hljs-operator">/</span><span class="hljs-operator">/</span> 创建Map实例</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="34"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">                var point <span class="hljs-operator">=</span> new BMap.Point(x,y); <span class="hljs-operator">/</span><span class="hljs-operator">/</span> 设置中心点坐标  </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="35"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">                map.centerAndZoom(point,<span class="hljs-number">12</span>); <span class="hljs-operator">/</span><span class="hljs-operator">/</span> 初始化地图,设置中心点坐标和地图级别、</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="36"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">                map.addControl(new BMap.MapTypeControl()); <span class="hljs-operator">/</span><span class="hljs-operator">/</span> 添加地图类型</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="37"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">				map.addControl(new BMap.OverviewMapControl()); <span class="hljs-operator">/</span><span class="hljs-operator">/</span> 添加地图类型控件</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="38"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">				map.addControl(new BMap.ScaleControl()); <span class="hljs-operator">/</span><span class="hljs-operator">/</span> 地图添加比例尺</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="39"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">				map.addControl(new BMap.NavigationControl()); <span class="hljs-operator">/</span><span class="hljs-operator">/</span> 地图添加缩放比例</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="40"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">                map.setCurrentCity(<span class="hljs-string">"上海"</span>); <span class="hljs-operator">/</span><span class="hljs-operator">/</span> 设置地图显示的城市,此项是必须设置的</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="41"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">                map.enableScrollWheelZoom(<span class="hljs-keyword">true</span>); <span class="hljs-operator">/</span><span class="hljs-operator">/</span> 开启鼠标滚轮缩放</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="42"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">     </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="43"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">                var geolocation <span class="hljs-operator">=</span> new BMap.Geolocation(); <span class="hljs-operator">/</span><span class="hljs-operator">/</span> geolocation 有<span class="hljs-number">2</span>个方法:getCurrentPosition、getStatus</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="44"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">                geolocation.getCurrentPosition(</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="45"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">                    <span class="hljs-keyword">function</span>(r){ <span class="hljs-operator">/</span><span class="hljs-operator">/</span> 成功的回调</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="46"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">                        console.log(<span class="hljs-string">"通过百度地图定位"</span>);</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="47"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">                        <span class="hljs-keyword">if</span>(this.getStatus() <span class="hljs-operator">=</span><span class="hljs-operator">=</span> BMAP_<span class="hljs-keyword">STATUS</span>_SUCCESS){   </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="48"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">                            var mk <span class="hljs-operator">=</span> new BMap.Marker(r.point);   </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="49"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">                            map.addOverlay(mk);   </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="50"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">                            map.panTo(r.point);   </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="51"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">                        }<span class="hljs-keyword">else</span> {   </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="52"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">                            alert(<span class="hljs-string">'failed'</span><span class="hljs-operator">+</span>this.getStatus()); <span class="hljs-operator">/</span><span class="hljs-operator">/</span> 此处的this指代 geolocation  </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="53"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">                        }</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="54"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">                    },</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="55"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">                    <span class="hljs-keyword">function</span>(<span class="hljs-keyword">error</span>){ <span class="hljs-operator">/</span><span class="hljs-operator">/</span> 失败的回调</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="56"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">                        switch(<span class="hljs-keyword">error</span>.<span class="hljs-keyword">code</span>) {</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="57"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">                            case <span class="hljs-keyword">error</span>.TIMEOUT:</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="58"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">                                tip.innerHTML <span class="hljs-operator">=</span> <span class="hljs-string">"A timeout occured! Please try again!发生超时！请重试！"</span>;</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="59"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">                                break;</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="60"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">                            case <span class="hljs-keyword">error</span>.POSITION_UNAVAILABLE:</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="61"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">                                tip.innerHTML <span class="hljs-operator">=</span> <span class="hljs-string">'We can\'</span>t detect your <span class="hljs-keyword">location</span>. Sorry!我们无法探测到你的位置,对不起！<span class="hljs-string"><span class="hljs-string">';</span></span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="62"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-string">                                break;</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="63"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-string">                            case error.PERMISSION_DENIED:</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="64"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-string">                                tip.innerHTML = '</span>Please allow geolocation <span class="hljs-keyword">access</span> <span class="hljs-keyword">for</span> this <span class="hljs-keyword">to</span> work.请允许访问地理位置<span class="hljs-string"><span class="hljs-string">';</span></span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="65"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-string">                                break;</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="66"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-string">                            case error.UNKNOWN_ERROR:</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="67"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-string">                                tip.innerHTML = '</span>An unknown <span class="hljs-keyword">error</span> occured!发生未知错误！<span class="hljs-string"><span class="hljs-string">';</span></span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="68"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-string">                                break;</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="69"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-string">                        }</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="70"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-string">                    },{</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="71"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-string">                    // 指示浏览器获取高精度的位置，默认为false</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="72"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-string">                    enableHighAccuracy: true,</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="73"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-string">                    // 指定获取地理位置的超时时间，默认不限时，单位为毫秒</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="74"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-string">                    timeout: 5000,</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="75"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-string">                    // 最长有效期，在重复获取地理位置时，此参数指定多久再次获取位置。</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="76"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-string">                    maximumAge: 3000</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="77"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-string">                })  </span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="78"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-string">            return; </span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="79"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-string">        }   </span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="80"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-string">        alert("你的浏览器不支持获取地理位置！");</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="81"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-string">    };   </span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="82"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-string">    function showPosition(position){  // 成功的回调</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="83"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-string">        console.log("通过原生H5的geolocation定位");</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="84"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-string">        x = position.coords.latitude; // 维度 </span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="85"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-string">        y = position.coords.longitude; // 经度</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="86"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-string">    };</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="87"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-string">&lt;/script&gt;</span></div></div></li></ol></code><div class="hide-preCode-box"><span class="hide-preCode-bt" data-report-view="{&quot;spm&quot;:&quot;1001.2101.3001.7365&quot;}"><img class="look-more-preCode contentImg-no-view" src="https://csdnimg.cn/release/blogv2/dist/pc/img/newCodeMoreWhite.png" alt="" title=""></span></div><div class="hljs-button signin" data-title="登录后复制" data-report-click="{&quot;spm&quot;:&quot;1001.2101.3001.4334&quot;}" onclick="hljs.signin(event)"></div></pre> 
</blockquote>
                </div><div data-report-view="{&quot;mod&quot;:&quot;1585297308_001&quot;,&quot;spm&quot;:&quot;1001.2101.3001.6548&quot;,&quot;dest&quot;:&quot;https://shao12138.blog.csdn.net/article/details/103340798&quot;,&quot;extend1&quot;:&quot;pc&quot;,&quot;ab&quot;:&quot;new&quot;}"><div></div></div>
        </div>